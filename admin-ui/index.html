<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>OLT Orchestrator Admin UI</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
  <!-- MarkerCluster CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css"/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css"/>

  <!-- Leaflet plugins CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder@3.3.1/dist/Control.Geocoder.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.fullscreen@5.2.1/Control.FullScreen.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.locatecontrol@0.85.1/dist/L.Control.Locate.min.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-easybutton@2.4.0/src/easy-button.css" />

  <!-- Tu CSS -->
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

  <!-- Navbar -->
  <header id="navbar">
    <div class="navbar-container">
      <span class="brand">aGIS OLT Orchestrator</span>
      <nav>
        <ul class="nav-links"></ul>
      </nav>
    </div>
  </header>

  <!-- Contenedor principal -->
  <div id="container">

    <!-- Sidebar izquierdo -->
    <div id="sidebar">
      <h3>Filtro mapa</h3>

      <div class="filter-row">
        <label for="map-olt-select">OLT</label>
        <select id="map-olt-select">
          <option value="">-- Selecciona OLT --</option>
        </select>
      </div>

      <div class="filter-row">
        <label for="map-pon-select">PON</label>
        <select id="map-pon-select" disabled>
          <option value="">-- Selecciona PON --</option>
        </select>
      </div>

      <div class="help">
        Selecciona una OLT y una PON para cargar ONTs ubicadas en el mapa.
      </div>

      <hr />
      <h3>Buscar CTO</h3>

      <div class="filter-row">
        <label for="cto-search-q">Nombre o UUID</label>
        <input id="cto-search-q" type="text" placeholder="Ej: CTO-ALORA-12, 7f2b..., ..." />
      </div>

      <div id="cto-search-results" class="search-results"></div>

      <div class="help">
        Tip: escribe 2+ caracteres. Click para centrar y abrir el popup.
      </div>

      <hr />
      <h3>Buscar ONT</h3>

      <div class="filter-row">
        <label for="ont-search-q">Texto</label>
        <input id="ont-search-q" type="text" placeholder="Ej: ont-3-1-12, 3-1-12, SN..." />
      </div>

      <div class="filter-row ont-checkbox-row">
        <input id="ont-search-only-unlocated" type="checkbox" checked />
        <label for="ont-search-only-unlocated" style="margin:0;">Solo sin ubicar</label>
      </div>

      <div id="ont-search-results" class="search-results"></div>

      <div class="help">
        Tip: escribe 2+ caracteres. Click en un resultado para ubicar o centrar en el mapa.
      </div>

      <hr />
      <h3>CSV ONTs</h3>

      <button id="btn-onts-csv-download" class="btn" style="width:100%;">Descargar CSV de ONTs</button>

      <div class="filter-row" style="margin-top:10px;">
        <label for="onts-csv-file">Importar CSV</label>
        <input id="onts-csv-file" type="file" accept=".csv,text/csv" />
      </div>

      <button id="btn-onts-csv-upload" class="btn" style="width:100%;">Importar y aplicar cambios</button>

      <div id="onts-csv-result" class="muted" style="margin-top:6px;"></div>
    </div>

    <!-- Mapa wrapper -->
    <main id="map-wrapper">
      <div id="map"></div>

      <!-- Loading overlay -->
      <div id="loading-overlay" class="loading hidden">
        <div class="spinner"></div>
        <div class="loading-text" id="loading-text">Cargando…</div>
      </div>

      <!-- Status bar -->
      <div id="status-bar">
        <span id="status-text">Sin filtro</span>
      </div>
    </main>

    <!-- Sidebar derecho: ONTs sin ubicar -->
    <aside id="sidebar-right" aria-label="Panel ONTs sin ubicar">
      <div class="side-header">
        <div class="side-title">
          <h3 style="margin:0;">ONTs sin ubicar</h3>
          <span id="unlocated-count" class="muted"></span>
        </div>

        <button id="btn-unlocated-toggle"
                class="icon-btn"
                type="button"
                aria-label="Colapsar panel ONTs sin ubicar"
                title="Colapsar/expandir">
          <span class="chev" aria-hidden="true">⟨</span>
        </button>
      </div>

      <div id="unlocated-tree"></div>
    </aside>

  </div>

  <!-- Logo en la esquina inferior izquierda del mapa -->
  <img src="img/AGIS_COLOR_SINFONDO.png" alt="Logo AGIS" class="map-logo">

  <!-- Leaflet -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>

  <!-- Leaflet plugins JS -->
  <script src="https://unpkg.com/leaflet-control-geocoder@3.3.1/dist/Control.Geocoder.js"></script>
  <script src="https://unpkg.com/leaflet.fullscreen@5.2.1/Control.FullScreen.js"></script>
  <script src="https://unpkg.com/leaflet.locatecontrol@0.85.1/dist/L.Control.Locate.min.js"></script>
  <script src="https://unpkg.com/leaflet-easybutton@2.4.0/src/easy-button.js"></script>

  <script type="module" src="js/app.js"></script>
</body>
</html>
